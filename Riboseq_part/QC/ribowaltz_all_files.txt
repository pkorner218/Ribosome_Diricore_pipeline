#####################



example_length_dist <- rlength_distr(reads_list, sample = here_name')
length_distr_plotdata <- example_length_dist[["plot"]]
ggsave(filename=here_name_length_distr.pdf', plot=length_distr_plotdata)


example_length_dist_zoom <- rlength_distr(reads_list, sample = here_name', cl = 99)
length_dist_zoom_plotdata <- example_length_dist_zoom[["plot"]]
ggsave(filename=here_name_length_dist_zoom.pdf', plot=length_dist_zoom_plotdata)


example_ends_heatmap <- rends_heat(reads_list, annotation_dt, sample = here_name', cl = 85, utr5l = 25, cdsl = 40, utr3l = 25)
ends_heatmap_plotdata <- example_ends_heatmap[["plot"]]
ggsave(filename=here_name_ends_heatmap.pdf', plot=ends_heatmap_plotdata)


example_psite_region <- region_psite(reads_psite_list, annotation_dt, sample = here_name')
psite_plotdata <- example_psite_region[["plot"]]
ggsave(filename=here_name_psite_region.pdf', plot=psite_plotdata)


example_frames_stratified <- frame_psite_length(reads_psite_list,sample = here_name', region = "all", cl = 90)
frames_stratified_plotdata <- example_frames_stratified[["plot"]]
ggsave(filename=here_name_frames_stratified.pdf', plot=frames_stratified_plotdata)


example_frames <- frame_psite(reads_psite_list, sample = here_name' ,region = "all")
frames_plotdata <- example_frames[["plot"]]
ggsave(filename=here_name_frames.pdf', plot=frames_plotdata)


example_metaprofile <- metaprofile_psite(reads_psite_list, annotation_dt, sample = here_name',
                                         utr5l = 20, cdsl = 40, utr3l = 20,
                                         plot_title = "auto")
example_metaprofile_plotdata <- example_metaprofile[["plot"]]
ggsave(filename=here_name_metaprofile.pdf', plot=example_metaprofile_plotdata)

df <- reads_list$here_name`
df$frame <- (df$psite_from_start%%3)


write.table(df, file=here_name.csv',sep=",",row.names=FALSE)

######################
